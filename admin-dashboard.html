<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard • QuizWave</title>

  <link rel="stylesheet" href="css/base.css" />
  <link rel="stylesheet" href="css/components.css" />
  <link rel="stylesheet" href="css/admin.css" />
  <style>
    :root{ --muted:#6b7280; --border:#e5e7eb; --soft:#f9fafb; }
    .layout { display:grid; grid-template-columns: 240px 1fr; gap:16px; }
    @media (max-width: 980px){ .layout { grid-template-columns: 1fr; } }
    .sidebar { background:#fff; border:1px solid var(--border); border-radius:12px; padding:14px; }
    .nav-list { list-style:none; margin:0; padding:0; display:grid; gap:8px; }
    .nav-list a { display:block; padding:8px 10px; border-radius:8px; border:1px solid transparent; }
    .nav-list a.active, .nav-list a:hover { background:var(--soft); border-color:var(--border); }
    .cards { display:grid; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); gap:12px; }
    .kpi { display:grid; gap:6px; }
    .kpi .value { font-size:28px; font-weight:800; }
    .muted { color:var(--muted); }
    .table { width:100%; border-collapse:separate; border-spacing:0 6px; }
    .table th, .table td { text-align:left; padding:8px 10px; background:#fff; border:1px solid var(--border); }
    .table th:first-child, .table td:first-child{ border-radius:8px 0 0 8px; }
    .table th:last-child, .table td:last-child{ border-radius:0 8px 8px 0; }
    .grid-auto { display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:18px; }
    .chip { display:inline-block; padding:2px 8px; border:1px solid var(--border); border-radius:999px; background:#fff; font-size:12px; }
    .row-soft { background:#fff; border:1px solid var(--border); border-radius:12px; padding:12px; }
    .actions { display:flex; gap:8px; flex-wrap:wrap; }
    .btn-sm { padding:6px 10px; font-size:14px; }
    .two { display:grid; grid-template-columns: 1fr auto; gap:8px; }
  </style>
</head>
<body>
  <div id="site-header"></div>

  <main class="container" style="padding:16px;">
    <div class="layout">
      <aside class="sidebar">
        <h4>Admin</h4>
        <nav>
          <ul class="nav-list">
            <li><a href="admin-dashboard.html" class="active">Overview</a></li>
            <li><a href="#admins">Admins</a></li>
            <li><a href="#users">Users</a></li>
            <li><a href="#quizzes">Quizzes</a></li>
            <li><a href="#live">Live Sessions</a></li>
            <li><a href="#analytics">Analytics</a></li>
          </ul>
        </nav>
      </aside>

      <section>
        <section class="hero">
          <h1>Platform Overview</h1>
          <p class="muted">Global metrics across users, quizzes, attempts, and live sessions.</p>
        </section>

        <!-- KPIs -->
        <section class="grid cards section">
          <div class="card"><div class="container"><div class="kpi"><div class="value" id="kTeachers">–</div><div>Teachers</div></div></div></div>
          <div class="card"><div class="container"><div class="kpi"><div class="value" id="kStudents">–</div><div>Students</div></div></div></div>
          <div class="card"><div class="container"><div class="kpi"><div class="value" id="kQuizzes">–</div><div>Total Quizzes</div></div></div></div>
          <div class="card"><div class="container"><div class="kpi"><div class="value" id="kAttempts">–</div><div>Total Attempts</div></div></div></div>
          <div class="card"><div class="container"><div class="kpi"><div class="value" id="kLiveAll">–</div><div>Live Sessions (All)</div></div></div></div>
          <div class="card"><div class="container"><div class="kpi"><div class="value" id="kLiveActive">–</div><div>Live Sessions (Active)</div></div></div></div>
          <div class="card"><div class="container"><div class="kpi"><div class="value" id="kLiveParticipants">–</div><div>Live Participants (All)</div></div></div></div>
        </section>

        <!-- Analytics -->
        <section id="analytics" class="section">
          <div class="grid-auto">
            <div class="card"><div class="container" style="height:280px;"><canvas id="userGrowth"></canvas></div></div>
            <div class="card"><div class="container" style="height:280px;"><canvas id="quizByTeacher"></canvas></div></div>
            <div class="card"><div class="container" style="height:280px;"><canvas id="attemptsByStudent"></canvas></div></div>
          </div>
        </section>

        <!-- Admin Management -->
        <section id="admins" class="section">
          <div class="row-soft">
            <h3>Admins</h3>
            <div class="two">
              <form id="addAdminForm" class="actions" onsubmit="return false;">
                <input id="adminEmail" class="input" type="email" placeholder="user@school.edu" required />
                <input id="adminName" class="input" type="text" placeholder="Name (optional)" />
                <button id="addAdminBtn" class="btn btn-sm">Add Admin</button>
              </form>
              <div><span class="chip" id="youAre">You: –</span></div>
            </div>
            <div style="margin-top:10px;">
              <table class="table" id="adminsTable">
                <thead><tr><th>Name</th><th>Email</th><th>Added</th><th>Actions</th></tr></thead>
                <tbody></tbody>
              </table>
            </div>
            <p class="muted" style="margin-top:8px;">Note: You cannot delete the last remaining admin.</p>
          </div>
        </section>

        <!-- Users -->
        <section id="users" class="card section">
          <div class="container">
            <h3>Recent Users</h3>
            <table class="table" id="usersTable">
              <thead><tr><th>Name</th><th>Role</th><th>Email</th><th>Created</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <!-- Quizzes -->
        <section id="quizzes" class="card section">
          <div class="container">
            <h3>Quizzes</h3>
            <table class="table" id="quizzesTable">
              <thead><tr><th>Title</th><th>Teacher</th><th>Created</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <!-- Live Sessions -->
        <section id="live" class="card section">
          <div class="container">
            <h3>Live Sessions</h3>
            <table class="table" id="liveTable">
              <thead><tr><th>Session</th><th>Quiz</th><th>Status</th><th>Participants</th><th>Started</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </section>
      </section>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/01-supabase-connection.js"></script>
  <script src="js/02-utils.js"></script>
  <script src="js/04-auth.js"></script>
  <script src="js/admin-dashboard.js"></script>
  <script src="js/site-shell.js"></script>
</body>
</html>
